select DATE_FORMAT(COL_TIME_ON, '%Y') as YEAR,
count(COL_MODE) as WORKED,
 (select count(*) as OM from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='FT8' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as OM
                                  from `TABLE_HRD_CONTACTS_V01` b
                                  where COL_SWL = 0
                                  and DATE_FORMAT(COL_TIME_ON, '%Y') = '2020'
                                  
 
 and DATE_FORMAT(COL_TIME_ON, '%Y') IN (WHERE Location.LocationID IN (select DISTINCT DATE_FORMAT(COL_TIME_ON, '%Y') as YEAR FROM `TABLE_HRD_CONTACTS_V01`)





                                  SELECT Location.LocationID, Location.Location
FROM Location


)
  (SELECT DISTINCT TransactionLocation 
   FROM Transactions
   WHERE Transactions.TransactionActivity = [Enter Activity] 
   AND Transactions.TransactionDate Between [Enter the start date:] And [Enter the end date:]);
   
   
   
   SELECT DATE_FORMAT(COL_TIME_ON, '%Y') as YEAR,
 (select count(*) as OM from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='FT8' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as OM
                                  from `TABLE_HRD_CONTACTS_V01` b
                                  where COL_SWL = 0
                                  and DATE_FORMAT(COL_TIME_ON, '%Y') IN (select DISTINCT DATE_FORMAT(COL_TIME_ON, '%Y') as YEAR FROM `TABLE_HRD_CONTACTS_V01`)
                                  group by DATE_FORMAT(COL_TIME_ON, '%Y') as YEAR
                                  
                                  
SELECT DATE_FORMAT(b.COL_TIME_ON, '%Y') as YEAR,
(select count(*) as OM from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='FT8' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as FT8,
(select count(*) as OM from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='FM' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as FM
from `TABLE_HRD_CONTACTS_V01` b
where b.COL_SWL = 0
and DATE_FORMAT(b.COL_TIME_ON, '%Y') = '2020'
group by DATE_FORMAT(b.COL_TIME_ON, '%Y')


SELECT DATE_FORMAT(b.COL_TIME_ON, '%Y') as YEAR,
(select count(*) as OM from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='FT8' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as FT8,
(select count(*) as OM from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='FM' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as FM
(select count(*) as OM from `TABLE_HRD_CONTACTS_V01` a where COL_MODE IN ('SSB','LSB','USB') and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as SSB
from `TABLE_HRD_CONTACTS_V01` b
where b.COL_SWL = 0
and DATE_FORMAT(b.COL_TIME_ON, '%Y') IN (select DISTINCT DATE_FORMAT(COL_TIME_ON, '%Y') as YEAR FROM `TABLE_HRD_CONTACTS_V01` order by DATE_FORMAT(COL_TIME_ON, '%Y'))



 IN (select DISTINCT DATE_FORMAT(COL_TIME_ON, '%Y') as YEAR FROM `TABLE_HRD_CONTACTS_V01`)
          
          
          
SELECT riempie1.* FROM riempie1
join (select idProdotto from riempie1 group by riempie1 having count(riempie1)=1) riempie2
on riempie1.idProdotto = riempie2.idProdotto

SELECT DATE_FORMAT(b.COL_TIME_ON, '%Y') as YEAR,
(select count(*) as OM from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='FT8' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as FT8,
(select count(*) as OM from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='FM' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as FM
from `TABLE_HRD_CONTACTS_V01` b
where b.COL_SWL = 0
join (select DATE_FORMAT(COL_TIME_ON, '%Y') as YEAR FROM `TABLE_HRD_CONTACTS_V01` c  )
and DATE_FORMAT(b.COL_TIME_ON, '%Y') IN (select DISTINCT DATE_FORMAT(COL_TIME_ON, '%Y') as YEAR FROM `TABLE_HRD_CONTACTS_V01`)
group by DATE_FORMAT(b.COL_TIME_ON, '%Y')


SELECT DATE_FORMAT(b.COL_TIME_ON, '%Y') as YEAR,
(select count(*) as OM from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='FT8' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as FT8,
(select count(*) as OM from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='FM' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as FM,
(select count(*) as OM from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='RTTY' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as RTTY,
(select count(*) as OM from `TABLE_HRD_CONTACTS_V01` a where COL_MODE IN ('SSB','LSB','USB') and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as SSB
from `TABLE_HRD_CONTACTS_V01` b
where b.COL_SWL = 0
and DATE_FORMAT(b.COL_TIME_ON, '%Y') IN (select DISTINCT DATE_FORMAT(COL_TIME_ON, '%Y') as YEAR FROM `TABLE_HRD_CONTACTS_V01`)
group by DATE_FORMAT(b.COL_TIME_ON, '%Y')

                     

SELECT DATE_FORMAT(b.COL_TIME_ON, '%Y') as YEAR,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='AM' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as AM,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='ARDOP' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as ARDOP,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='ATV' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as ATV,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='C4FM' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as C4FM,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='CHIP' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as CHIP,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='CLO' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as CLO,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='CONTESTI' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as CONTESTI,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='CW' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as CW,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='DIGITALVOICE' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as DIGITALVOICE,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='DOMINO' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as DOMINO,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='DSTAR' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as DSTAR,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='FAX' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as FAX,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='FM' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as FM,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='FSK441' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as FSK441,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='FT8' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as FT8,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='HELL' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as HELL,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='ISCAT' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as ISCAT,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='JT4' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as JT4,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='JT6M' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as JT6M,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='JT9' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as JT9,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='JT44' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as JT44,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='JT65' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as JT65,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='MFSK' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as MFSK,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='MSK144' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as MSK144,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='MT63' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as MT63,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='OLIVIA' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as OLIVIA,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='OPERA' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as OPERA,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='PAC' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as PAC,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='PAX' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as PAX,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='PKT' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as PKT,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='PSK' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as PSK,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='PSK2K' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as PSK2K,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='Q15' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as Q15,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='QRA64' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as QRA64,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='ROS' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as ROS,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='RTTY' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as RTTY,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='RTTYM' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as RTTYM,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='SSB' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as SSB,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='SSTV' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as SSTV,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='T10' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as T10,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='THOR' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as THOR,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='THRB' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as THRB,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='TOR' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as TOR,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='V4' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as V4,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='VOI' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as VOI,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='WINMOR' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as WINMOR,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='WSPR' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as WSPR,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='AMTORFEC' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as AMTORFEC,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='ASCI' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as ASCI,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='CHIP64' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as CHIP64,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='CHIP128' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as CHIP128,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='DOMINOF' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as DOMINOF,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='FMHELL' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as FMHELL,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='FSK31' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as FSK31,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='GTOR' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as GTOR,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='HELL80' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as HELL80,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='HFSK' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as HFSK,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='JT4A' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as JT4A,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='JT4B' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as JT4B,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='JT4C' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as JT4C,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='JT4D' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as JT4D,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='JT4E' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as JT4E,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='JT4F' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as JT4F,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='JT4G' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as JT4G,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='JT65A' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as JT65A,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='JT65B' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as JT65B,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='JT65C' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as JT65C,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='MFSK8' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as MFSK8,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='MFSK16' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as MFSK16,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='PAC2' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as PAC2,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='PAC3' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as PAC3,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='PAX2' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as PAX2,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='PCW' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as PCW,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='PSK10' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as PSK10,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='PSK31' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as PSK31,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='PSK63' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as PSK63,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='PSK63F' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as PSK63F,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='PSK125' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as PSK125,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='PSKAM10' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as PSKAM10,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='PSKAM31' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as PSKAM31,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='PSKAM50' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as PSKAM50,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='PSKFEC31' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as PSKFEC31,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='PSKHELL' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as PSKHELL,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='QPSK31' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as QPSK31,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='QPSK63' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as QPSK63,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='QPSK125' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as QPSK125,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE ='THRBX' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as THRBX
from `TABLE_HRD_CONTACTS_V01` b
where b.COL_SWL = 0
and DATE_FORMAT(b.COL_TIME_ON, '%Y') IN (select DISTINCT DATE_FORMAT(COL_TIME_ON, '%Y') as YEAR FROM `TABLE_HRD_CONTACTS_V01`)
group by DATE_FORMAT(b.COL_TIME_ON, '%Y')
              
              
              
              
              
              
              
              
              ************** view ******************

CREATE OR REPLACE SQL SECURITY INVOKER VIEW VIEW_HRD_QSOYEARMODE_PA1REG AS
SELECT DATE_FORMAT(b.COL_TIME_ON, '%Y') as YEAR,
(select count(*) from `TABLE_HRD_CONTACTS_V01` a where COL_MODE = 'FT8' and col_swl=0 and DATE_FORMAT(a.COL_TIME_ON, '%Y')=DATE_FORMAT(b.COL_TIME_ON, '%Y')) as FT8
from `TABLE_HRD_CONTACTS_V01` b
where b.COL_SWL = 0
and DATE_FORMAT(b.COL_TIME_ON, '%Y') IN (select DISTINCT DATE_FORMAT(COL_TIME_ON, '%Y') as YEAR FROM `TABLE_HRD_CONTACTS_V01`)
group by DATE_FORMAT(b.COL_TIME_ON, '%Y')



Select YEAR, FT8 from VIEW_HRD_QSOYEARMODE_PA1REG
