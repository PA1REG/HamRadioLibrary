$a=Get-AdifFile -FileName Z:\Repos\HamRadioLibrary\src\Eqsl.ccInbox_25122020.adi

$a |Select-Object call,qslmsg,qslmsg_int | Where-Object { $PSItem.QSLMSG -ne "" -or $PSItem.QSLMSG_INT -ne "" }|ft -AutoSize
$a |Select-Object call,qslmsg | Where-Object { $PSItem.QSLMSG -or $PSItem.QSLMSG_INT } | ft -AutoSize
 
 
$b=$a | Where-Object { $PSItem.QSLMSG -or $PSItem.QSLMSG_INT } 
  
$b | Export-Csv -Path eQsl.ccWithComment.csv -Encoding ascii -NoTypeInformation
  
 
 
$b = $a | Select-Object CALL,QSO_DATE, TIME_ON,	TIME_OFF,	BAND,	MODE,	RST_SENT,	RST_RCVD,	QSL_SENT, QSLMSG,	QSLMSG_INTL | Where-Object { $PSItem.QSLMSG -or $PSItem.QSLMSG_INT } 
$b | Export-Csv -Path eQsl.ccWithComment.csv -Encoding ascii -NoTypeInformation
 
 
"<EOH><CALL:5>DK6JM<QSO_DATE:8:D>19980411<TIME_ON:4>1711<BAND:3>40M<MODE:3>SSB<RST_SENT:2>59<RST_RCVD:0><QSL_SENT:1>Y<QSL_SENT_VIA:1>E<APP_EQSL_AG:1>Y<GRIDSQUARE:6>jo31jg<EOR>"



$AdifRecords = Get-AdifFile -FileName Z:\Repos\HamRadioLibrary\src\Eqsl.ccInbox_25122020.adi
$AdifFoundArray = @()
foreach ($AdifRecord in $AdifRecords) { 
     Write-Host("Check: $($AdifRecord.Call)") -ForegroundColor Green
     if ($AdifRecord.QSLMSG.Length > 0) 
     {
         Write-Host("Found : $($AdifRecord.Call)") -ForegroundColor Red
         $AdifFoundArray += $AdifRecord
     }
}
$AdifFoundArray

$SwlContacts = $AdifRecords | Select-Object Call, qslmsg | Where-Object { $PSItem.QSLMSG -like "*wkd*" -or $PSItem.QSLMSG -like "*working*"  -or $PSItem.QSLMSG -like "*wsl*" -or $PSItem.QSLMSG -like "*heard*" -or $PSItem.QSLMSG -like "*report*" }

cd Z:\Repos\HamRadioLibrary\build\
.\Build-Debug.ps1
Import-Module HamRadioLibrary -fo
$AdifRecords = Get-AdifFile -FileName Z:\Repos\HamRadioLibrary\src\Eqsl.ccInbox_25122020.adi
$SwlContacts = $AdifRecords | Where-Object { $PSItem.QSLMSG -like "*wkd*" -or $PSItem.QSLMSG -like "*working*"  -or $PSItem.QSLMSG -like "*wsl*" -or $PSItem.QSLMSG -like "*heard*" -or $PSItem.QSLMSG -like "*report*" }
$SwlContacts | Export-Csv -Path Z:\Repos\HamRadioLibrary\src\SwlContacts.csv -Encoding ascii -NoTypeInformation
Convert-CsvToAdif -CsvFileName Z:\Repos\HamRadioLibrary\src\SwlContacts.csv -AdifFileName Z:\Repos\HamRadioLibrary\src\SwlContacts.adi -Swl -QslMsgCopyToComment


Start-HrdSwlContacts -AdifFile Z:\Repos\HamRadioLibrary\src\Eqsl.ccInbox_25122020.adi -CsvFileSwlContacts -AdifFileSwlContacts

wkd
working
swl
heard
